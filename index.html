<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Wheel of Fortune ‚Äî Blue Glass Edition</title>

<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  background-image: url('4.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  font-family: 'Poppins', sans-serif;
  color: #003a63;
  padding: 40px 0;
}

h1 {
  font-family: 'Fredoka One', cursive;
  font-size: 52px;
  color: #f0f9ff;
  text-shadow: 0 0 10px rgba(0, 100, 200, 0.8), 0 0 20px rgba(255,255,255,0.7);
  margin-bottom: 25px;
  animation: float 3s ease-in-out infinite;
}

.container {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 40px;
  background: rgba(255,255,255,0.45);
  backdrop-filter: blur(20px);
  border-radius: 30px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
}

/* —Å—Ç—Ä–µ–ª–∫–∞ */
.arrow {
  position: absolute;
  top: 3px;
  left: 50%;
  transform: translateX(-50%) rotate(0deg);
  width: 0;
  height: 0;
  border-left: 20px solid transparent;
  border-right: 20px solid transparent;
  border-top: 35px solid #ffffff;
  filter: drop-shadow(0 0 8px rgba(80, 180, 255, 0.9))
          drop-shadow(0 0 15px rgba(80, 180, 255, 0.6))
          drop-shadow(0 0 25px rgba(120, 200, 255, 0.4));
  z-index: 10;
  animation: sway 2s ease-in-out infinite;
  transition: filter 0.3s ease;
}

.arrow:hover {
  filter: drop-shadow(0 0 12px rgba(100,200,255,1))
          drop-shadow(0 0 25px rgba(120,220,255,0.9))
          drop-shadow(0 0 45px rgba(150,230,255,0.8));
}

/* canvas */
#wheel {
  border-radius: 50%;
  background: radial-gradient(circle at center, #e6f7ff 0%, #8dc8ff 70%, #007fe0 100%);
  box-shadow:
    inset 0 0 40px rgba(255,255,255,0.6),
    0 0 25px rgba(0,120,255,0.6),
    0 10px 25px rgba(0,0,0,0.25);
  border: 6px solid rgba(255,255,255,0.6);
}

/* –∫–Ω–æ–ø–∫–∏ –∏ –ø–æ–ª–µ */
#code-box {
  margin-top: 25px;
  padding: 25px;
  background: rgba(255,255,255,0.45);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  text-align: center;
  width: 340px;
  box-shadow: 0 5px 25px rgba(0,0,0,0.2);
}

#code-box h3 {
  font-family: 'Fredoka One', cursive;
  font-size: 23px;
  color: #007fe0;
  margin-top: 0;
  margin-bottom: 15px;
  text-shadow: 0 0 8px rgba(255, 255, 255, 0.6);
  letter-spacing: 1px;
}

input {
  width: 80%;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.5);
  background: rgba(255,255,255,0.25);
  color: #003a63;
  font-size: 16px;
  text-align: center;
  outline: none;
}
button {
  margin-top: 15px;
  padding: 12px 24px;
  border-radius: 12px;
  background: linear-gradient(135deg, #5bb6ff, #1d8fe8);
  color: #fff;
  font-size: 18px;
  border: none;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.2);
  transition: 0.3s;
}
button:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 25px rgba(0,0,0,0.25);
}
#status { margin-top: 10px; font-weight: 500; }

/* –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
#admin-panel {
  margin-top: 40px;
  padding: 20px;
  width: 380px;
  background: rgba(255,255,255,0.4);
  backdrop-filter: blur(20px);
  border-radius: 25px;
  display: none;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}
#codes-list, #used-list {
  background: rgba(255,255,255,0.3);
  border-radius: 10px;
  padding: 10px;
  max-height: 150px;
  overflow-y: auto;
  text-align: left;
  border: 1px solid rgba(255,255,255,0.5);
  margin-bottom: 10px;
  color: #003a63;
  font-size: 14px;
}

/* === –í–°–ü–õ–´–í–ê–Æ–©–ï–ï –û–ö–ù–û –ü–û–ë–ï–î–´ === */
#win-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 20, 60, 0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 999;
  animation: fadeIn 0.5s ease forwards;
}

.popup-content {
  background: rgba(200, 235, 255, 0.8);
  border-radius: 25px;
  padding: 40px 60px;
  text-align: center;
  box-shadow:
    0 0 20px rgba(0, 100, 200, 0.9),
    0 0 60px rgba(0, 150, 255, 0.7);
  backdrop-filter: blur(15px);
  transform: scale(0.95);
  animation: popIn 0.6s ease forwards;
}

.popup-content h2 {
  color: #0066cc;
  font-size: 52px;
  margin: 0 0 20px 0;
  text-shadow: 0 0 12px rgba(180,220,255,0.9);
  font-family: 'Fredoka One', cursive;
}

.popup-content p {
  color: #003366;
  font-size: 32px;
  font-family: 'Fredoka One', cursive;
  margin-bottom: 45px;
  font-weight: 600;
  letter-spacing: 0.5px;
}

#try-again-btn {
  padding: 14px 32px;
  font-size: 18px;
  border: none;
  border-radius: 15px;
  background: linear-gradient(135deg, #007fff, #64c3ff);
  color: white;
  cursor: pointer;
  box-shadow: 0 0 20px rgba(0,150,255,0.7);
  transition: all 0.3s ease;
}

#try-again-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 30px rgba(100,200,255,0.9);
}

/* –∞–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}
@keyframes sway {
  0%, 100% { transform: translateX(-50%) rotate(0deg); }
  50% { transform: translateX(-50%) rotate(-6deg); }
}
@keyframes fadeIn {
  from {opacity: 0;}
  to {opacity: 1;}
}
@keyframes popIn {
  0% {transform: scale(0.8);}
  100% {transform: scale(1);}
}
</style>
</head>
<body>

<h1>ü¶ãWheel of Fortuneü¶ã</h1>

<div class="container">
  <div class="arrow"></div>
  <canvas id="wheel" width="400" height="400"></canvas>

  <div id="code-box">
    <h3>üëâEnter your lucky codeüëà</h3>
    <input id="code-input" type="text" placeholder="Are you ready?">
    <button onclick="activateCode()">ü©µSPINü©µ</button>
    <p id="status"></p>
  </div>
</div>

<!-- –í–°–ü–õ–´–í–ê–Æ–©–ï–ï –û–ö–ù–û –ü–û–ë–ï–î–´ -->
<div id="win-popup">
  <div class="popup-content">
    <h2>You Win!</h2>
    <p id="win-result">Your prize appears here.</p>
    <button id="try-again-btn" onclick="closePopup()">üí¶Let‚Äôs try again?üí¶</button>
  </div>
</div>

<div id="admin-panel">
  <h2>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
  <button onclick="generateCodes()">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –∫–æ–¥—ã</button>
  <button onclick="clearUsed()">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ</button>
  <button onclick="clearAll()">–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–¥—ã</button>

  <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–¥—ã</h3>
  <div id="codes-list"></div>

  <h3>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–¥—ã</h3>
  <div id="used-list"></div>
</div>

<script>
let codes = JSON.parse(localStorage.getItem("codes") || "[]");
let used = JSON.parse(localStorage.getItem("used") || "[]");
let currentCode = null;

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const center = canvas.width / 2;
const radius = center;
const values = ["Pussy","Tits","Sexting","Custom","Striptease","Anal","Masturbation","Video chat","Dildoplay","Blowjob"];
const count = values.length;

drawWheel();

function drawWheel() {
  const angleStep = (2 * Math.PI) / count;
  for (let i = 0; i < count; i++) {
    const start = i * angleStep;
    const end = start + angleStep;
    const grad = ctx.createLinearGradient(center - radius / 2, 0, center + radius, 0);
    grad.addColorStop(0, i % 2 ? '#5aaeff' : '#7fc8ff');
    grad.addColorStop(1, i % 2 ? '#8fd3ff' : '#64baff');

    ctx.beginPath();
    ctx.moveTo(center, center);
    ctx.arc(center, center, radius - 6, start, end);
    ctx.fillStyle = grad;
    ctx.fill();
    ctx.closePath();

    ctx.save();
    ctx.translate(center, center);
    ctx.rotate(start + angleStep / 2);
    ctx.fillStyle = '#041A2F';
    ctx.font = '600 22px "Baloo 2", sans-serif';
    ctx.textAlign = 'right';
    ctx.fillText(values[i], radius - 40, 8);
    ctx.restore();
  }
}

let spinning = false;
let rotation = 0;

// –¥–æ–±–∞–≤—å —ç—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä—è–¥–æ–º —Å –¥—Ä—É–≥–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
const FULL_ROTATIONS = 10;   // —Å–∫–æ–ª—å–∫–æ –ø–æ–ª–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–æ–≤ –¥–µ–ª–∞—Ç—å
const PNG_CORRECTION = -13;  // —Ç–≤–æ—è —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞ (–º–æ–∂–Ω–æ –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å)

// –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —è–≤–Ω–æ —Å—Ç–∞–≤–∏–º —Ü–µ–Ω—Ç—Ä –∫–∞–∫ origin (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
canvas.style.transformOrigin = "50% 50%";

function spin() {
  if (spinning) return;
  spinning = true;

  let result = currentCode?.result;
  if (!result) {
    const randomIndex = Math.floor(Math.random() * values.length);
    result = values[randomIndex];
  }

  const targetIndex = values.indexOf(result);
  if (targetIndex === -1) {
    console.error("Result not found in values:", result);
    // fallback
    spinning = false;
    return;
  }

  const anglePerSector = 360 / values.length;

  // —Ü–µ–Ω—Ç—Ä –Ω—É–∂–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞ (–≤ –≥—Ä–∞–¥—É—Å–∞—Ö, 0¬∞ ‚Äî –Ω–∞–ø—Ä–∞–≤–æ, —É–≥–æ–ª —Ä–∞—Å—Ç—ë—Ç –ø–æ —á–∞—Å–æ–≤–æ–π)
  const sectorCenter = targetIndex * anglePerSector + anglePerSector / 2;

  // --- –ö–õ–Æ–ß–ï–í–ê–Ø –§–û–†–ú–£–õ–ê ---
  // —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã sectorCenter (–ø–æ—Å–ª–µ –≤—Ä–∞—â–µ–Ω–∏—è) –æ–∫–∞–∑–∞–ª—Å—è –≤ —Ç–æ—á–∫–µ "–≤–≤–µ—Ä—Ö—É" = 270¬∞
  // finalRotation –¥–æ–ª–∂–µ–Ω —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å: (sectorCenter + finalRotation) % 360 == 270
  // => finalRotation = 270 - sectorCenter  (–¥–æ–±–∞–≤–∏–º –ø–æ–ª–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã –∏ PNG_CORRECTION)
  let finalRotation = FULL_ROTATIONS * 360 + (270 - sectorCenter) + PNG_CORRECTION;

  // –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
  const finalRotationNorm = ((finalRotation % 360) + 360) % 360;

  console.log("spin() debug:",
    { result, targetIndex, anglePerSector, sectorCenter, PNG_CORRECTION,
      finalRotation, finalRotationNorm });

  // –ø—Ä–∏–º–µ–Ω—è–µ–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é
  canvas.style.transition = "transform 5s cubic-bezier(.17,.67,.38,1.35)";
  canvas.style.transform = `rotate(${finalRotation}deg)`;

  // –ß–µ—Ä–µ–∑ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∏–º "–ø–æ—Å–∞–¥–∫—É"
  setTimeout(() => {
    // —É–≥–æ–ª, –ø–æ–¥ –∫–æ—Ç–æ—Ä—ã–º "—Ü–µ–Ω—Ç—Ä —Å–µ–∫—Ç–æ—Ä–∞" –æ–∫–∞–∑–∞–ª—Å—è –≤–∏–∑—É–∞–ª—å–Ω–æ (0..359)
    const landedAngle = ((sectorCenter + finalRotation) % 360 + 360) % 360;

    // –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–∫–æ –∫ 270¬∞ (—Å—Ç—Ä–µ–ª–∫–∞)
    const delta = ((landedAngle - 270 + 540) % 360) - 180; // –æ—Ç -180..180

    // –≤—ã—á–∏—Å–ª–∏–º –∫–∞–∫–æ–π —Å–µ–∫—Ç–æ—Ä —Ä–µ–∞–ª—å–Ω–æ –ø–æ–ø–∞–ª –ø–æ–¥ —Å—Ç—Ä–µ–ª–∫—É (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    // —Å—Ä–∞–≤–Ω–∏–º –≤—Å–µ —Å–µ–∫—Ç–æ—Ä-—Ü–µ–Ω—Ç—Ä—ã, –≤—ã–±–µ—Ä–µ–º –±–ª–∏–∂–∞–π—à–∏–π –∫ 270
    let nearestIndex = 0;
    let nearestDiff = 360;
    for (let i = 0; i < values.length; i++) {
      const c = i * anglePerSector + anglePerSector / 2;
      const landed = ((c + finalRotation) % 360 + 360) % 360;
      let d = Math.abs(((landed - 270 + 540) % 360) - 180);
      if (d < nearestDiff) { nearestDiff = d; nearestIndex = i; }
    }

    console.log("spin() landed debug:",
      { landedAngle, delta, nearestIndex, nearestDiff, expectedIndex: targetIndex });

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –∏–º–µ–Ω–Ω–æ —Å result (–∫–∞–∫ —É —Ç–µ–±—è –±—ã–ª–æ)
    showPopup(result);

    if (currentCode) {
      used.push({ code: currentCode.code, result });
      localStorage.setItem("used", JSON.stringify(used));
      updateLists();
      currentCode = null;
    }

    spinning = false;
  }, 5200);
}


function showPopup(prize) {
  document.getElementById("win-result").innerText = "üéÅ " + prize;
  document.getElementById("win-popup").style.display = "flex";
}
function closePopup() {
  document.getElementById("win-popup").style.display = "none";
}

function activateCode() {
  const value = document.getElementById("code-input").value.trim().toUpperCase();
  const status = document.getElementById("status");

  // –≤—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω–∫—É
  if (value === "ADMIN123") {
    document.getElementById("admin-panel").style.display = "block";
    status.innerText = "–ê–¥–º–∏–Ω-—Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω ‚úîÔ∏è";
    updateLists();
    return;
  }

  // –ø–æ–∏—Å–∫ –∫–æ–¥–∞ (–æ–±—ä–µ–∫—Ç —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º)
  const found = codes.find(c => c.code === value);
  if (!found) {
    status.innerText = "‚ùå Invalid or used code ‚ùå";
    return;
  }

  currentCode = found;
  status.innerText = "Code accepted! üåÄ Let's spin it...";
  spin();

  // —É–¥–∞–ª—è–µ–º –µ–≥–æ –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö
  codes = codes.filter(c => c.code !== value);
  localStorage.setItem("codes", JSON.stringify(codes));
}

function generateCodes() {
  const count = parseInt(prompt("–°–∫–æ–ª—å–∫–æ –∫–æ–¥–æ–≤ —Å–æ–∑–¥–∞—Ç—å?"));
  if (!count || count <= 0) return;
  const newList = [];

  for (let i = 0; i < count; i++) {
    const code = Math.random().toString(36).substring(2,10).toUpperCase();
    const result = prompt(`–í–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∫–æ–¥–∞ ${code}:`, "Lucky!");
    const item = { code, result };
    codes.push(item);
    newList.push(`${code} ‚Äî ${result}`);
  }
  localStorage.setItem("codes", JSON.stringify(codes));
  alert("–°–æ–∑–¥–∞–Ω—ã –∫–æ–¥—ã:\n" + newList.join("\n"));
  updateLists();
}

function clearUsed() {
  used = [];
  localStorage.setItem("used", "[]");
  updateLists();
}

function clearAll() {
  codes = [];
  used = [];
  localStorage.setItem("codes","[]");
  localStorage.setItem("used","[]");
  updateLists();
}

function updateLists() {
  document.getElementById("codes-list").innerText =
    codes.length
      ? codes
          .map(item => `${item.code} ‚Äî ${item.result}`)
          .join("\n")
      : "–ü—É—Å—Ç–æ";

  document.getElementById("used-list").innerText =
    used.length
      ? used
          .map(item => `${item.code} ‚Äî ${item.result}`)
          .join("\n")
      : "–ü—É—Å—Ç–æ";
}
</script>
</body>
</html>