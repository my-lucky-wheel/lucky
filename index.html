<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Wheel of Fortune ‚Äî Blue Glass Edition</title>

<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  background-image: url('4.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  font-family: 'Poppins', sans-serif;
  color: #003a63;
  padding: 40px 0;
}

h1 {
  font-family: 'Fredoka One', cursive;
  font-size: 52px;
  color: #f0f9ff;
  text-shadow: 0 0 10px rgba(0, 100, 200, 0.8), 0 0 20px rgba(255,255,255,0.7);
  margin-bottom: 25px;
  animation: float 3s ease-in-out infinite;
}

.container {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 40px;
  background: rgba(255,255,255,0.45);
  backdrop-filter: blur(20px);
  border-radius: 30px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
}

/* —Å—Ç—Ä–µ–ª–∫–∞ */
.arrow {
  position: absolute;
  top: 3px;
  left: 50%;
  transform: translateX(-50%) rotate(0deg);
  width: 0;
  height: 0;
  border-left: 20px solid transparent;
  border-right: 20px solid transparent;
  border-top: 35px solid #ffffff;
  filter: drop-shadow(0 0 8px rgba(80, 180, 255, 0.9))
          drop-shadow(0 0 15px rgba(80, 180, 255, 0.6))
          drop-shadow(0 0 25px rgba(120, 200, 255, 0.4));
  z-index: 10;
  animation: sway 2s ease-in-out infinite;
  transition: filter 0.3s ease;
}

.arrow:hover {
  filter: drop-shadow(0 0 12px rgba(100,200,255,1))
          drop-shadow(0 0 25px rgba(120,220,255,0.9))
          drop-shadow(0 0 45px rgba(150,230,255,0.8));
}

/* canvas */
#wheel {
  border-radius: 50%;
  background: radial-gradient(circle at center, #e6f7ff 0%, #8dc8ff 70%, #007fe0 100%);
  box-shadow:
    inset 0 0 40px rgba(255,255,255,0.6),
    0 0 25px rgba(0,120,255,0.6),
    0 10px 25px rgba(0,0,0,0.25);
  border: 6px solid rgba(255,255,255,0.6);
}

/* –∫–æ–¥ + –∫–Ω–æ–ø–∫–∏ */
#code-box {
  margin-top: 25px;
  padding: 25px;
  background: rgba(255,255,255,0.45);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  text-align: center;
  width: 340px;
  box-shadow: 0 5px 25px rgba(0,0,0,0.2);
}

#code-box h3 {
  font-family: 'Fredoka One', cursive;
  font-size: 23px;
  color: #007fe0;
  margin-top: 0;
  margin-bottom: 15px;
  text-shadow: 0 0 8px rgba(255, 255, 255, 0.6);
  letter-spacing: 1px;
}

input {
  width: 80%;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.5);
  background: rgba(255,255,255,0.25);
  color: #003a63;
  font-size: 16px;
  text-align: center;
  outline: none;
}
button {
  margin-top: 15px;
  padding: 12px 24px;
  border-radius: 12px;
  background: linear-gradient(135deg, #5bb6ff, #1d8fe8);
  color: #fff;
  font-size: 18px;
  border: none;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.2);
  transition: 0.3s;
}
button:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 25px rgba(0,0,0,0.25);
}
#status { margin-top: 10px; font-weight: 500; }

/* –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
#admin-panel {
  margin-top: 40px;
  padding: 20px;
  width: 380px;
  background: rgba(255,255,255,0.4);
  backdrop-filter: blur(20px);
  border-radius: 25px;
  display: none;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}
#codes-list {
  background: rgba(255,255,255,0.3);
  border-radius: 10px;
  padding: 10px;
  max-height: 150px;
  overflow-y: auto;
  text-align: left;
  border: 1px solid rgba(255,255,255,0.5);
  margin-bottom: 10px;
  color: #003a63;
  font-size: 14px;
}

/* –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ */
#win-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 20, 60, 0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 999;
  animation: fadeIn 0.5s ease forwards;
}

.popup-content {
  background: rgba(200, 235, 255, 0.8);
  border-radius: 25px;
  padding: 40px 60px;
  text-align: center;
  box-shadow:
    0 0 20px rgba(0, 100, 200, 0.9),
    0 0 60px rgba(0, 150, 255, 0.7);
  backdrop-filter: blur(15px);
  transform: scale(0.95);
  animation: popIn 0.6s ease forwards;
}

.popup-content h2 {
  color: #0066cc;
  font-size: 52px;
  margin: 0 0 20px 0;
  text-shadow: 0 0 12px rgba(180,220,255,0.9);
  font-family: 'Fredoka One', cursive;
}

.popup-content p {
  color: #003366;
  font-size: 32px;
  font-family: 'Fredoka One', cursive;
  margin-bottom: 45px;
  font-weight: 600;
  letter-spacing: 0.5px;
}

#try-again-btn {
  padding: 14px 32px;
  font-size: 18px;
  border: none;
  border-radius: 15px;
  background: linear-gradient(135deg, #007fff, #64c3ff);
  color: white;
  cursor: pointer;
  box-shadow: 0 0 20px rgba(0,150,255,0.7);
  transition: all 0.3s ease;
}

#try-again-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 30px rgba(100,200,255,0.9);
}

/* –∞–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}
@keyframes sway {
  0%, 100% { transform: translateX(-50%) rotate(0deg); }
  50% { transform: translateX(-50%) rotate(-6deg); }
}
@keyframes fadeIn {
  from {opacity: 0;}
  to {opacity: 1;}
}
@keyframes popIn {
  0% {transform: scale(0.8);}
  100% {transform: scale(1);}
}
</style>
</head>
<body>

<h1>ü¶ãWheel of Fortuneü¶ã</h1>

<div class="container">
  <div class="arrow"></div>
  <canvas id="wheel" width="400" height="400"></canvas>

  <div id="code-box">
    <h3>üëâEnter your lucky codeüëà</h3>
    <input id="code-input" type="text" placeholder="Are you ready?">
    <button onclick="activateCode()">ü©µSPINü©µ</button>
    <p id="status"></p>
  </div>
</div>

<!-- –í–°–ü–õ–´–í–ê–Æ–©–ï–ï –û–ö–ù–û –ü–û–ë–ï–î–´ -->
<div id="win-popup">
  <div class="popup-content">
    <h2>You Win!</h2>
    <p id="win-result">Your prize appears here.</p>
    <button id="try-again-btn" onclick="closePopup()">üí¶Let‚Äôs try again?üí¶</button>
  </div>
</div>

<!-- –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ -->
<div id="admin-panel">
  <h2>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
  <button onclick="generateCode()">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–¥</button>

  <h3>–ö–æ–¥—ã</h3>
  <div id="codes-list"></div>
</div>

<!-- FIREBASE + –õ–û–ì–ò–ö–ê -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import {
    getFirestore,
    collection,
    doc,
    setDoc,
    getDoc,
    getDocs,
    updateDoc
  } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDHccUpdFS9YCPArBtGoIMobSGggzj3T3Q",
    authDomain: "lucky-wheel-7612a.firebaseapp.com",
    projectId: "lucky-wheel-7612a",
    storageBucket: "lucky-wheel-7612a.firebasestorage.app",
    messagingSenderId: "15125075566",
    appId: "1:15125075566:web:1fa4d2ea10503c7138387f",
    measurementId: "G-RS5TLLWC0Z"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const codesRef = collection(db, "codes");

  // ------------ –†–ò–°–£–ï–ú –ö–û–õ–ï–°–û ------------
  const wheelCanvas = document.getElementById("wheel");
  const ctx = wheelCanvas.getContext("2d");
  const center = wheelCanvas.width / 2;
  const radius = center;

  const values = [
    "Pussy","Tits","Sexting","Custom","Striptease",
    "Anal","Masturbation","Video chat","Dildoplay","Blowjob"
  ];
  const count = values.length;

  function drawWheel() {
    const angleStep = (2 * Math.PI) / count;
    for (let i = 0; i < count; i++) {
      const start = i * angleStep;
      const end = start + angleStep;

      const grad = ctx.createLinearGradient(center - radius / 2, 0, center + radius, 0);
      grad.addColorStop(0, i % 2 ? '#5aaeff' : '#7fc8ff');
      grad.addColorStop(1, i % 2 ? '#8fd3ff' : '#64baff');

      ctx.beginPath();
      ctx.moveTo(center, center);
      ctx.arc(center, center, radius - 6, start, end);
      ctx.fillStyle = grad;
      ctx.fill();
      ctx.closePath();

      ctx.save();
      ctx.translate(center, center);
      ctx.rotate(start + angleStep / 2);
      ctx.fillStyle = '#041A2F';
      ctx.font = '600 22px "Baloo 2", sans-serif';
      ctx.textAlign = 'right';
      ctx.fillText(values[i], radius - 40, 8);
      ctx.restore();
    }
  }
  drawWheel();

  // ------------ POPUP ------------
  function showPopup(prize) {
    document.getElementById("win-result").innerText = "üéÅ " + prize;
    document.getElementById("win-popup").style.display = "flex";
  }

  function closePopup() {
    document.getElementById("win-popup").style.display = "none";
  }
  window.closePopup = closePopup;

  // ------------ –ê–î–ú–ò–ù: –°–û–ó–î–ê–¢–¨ –ö–û–î ------------
  async function generateCode() {
    const code = Math.random().toString(36).substring(2, 10).toUpperCase();
    const prize = prompt(`–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–∑ –¥–ª—è –∫–æ–¥–∞ ${code}:`, "Pussy");

    if (!prize) {
      alert("–ü—Ä–∏–∑ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω");
      return;
    }

    await setDoc(doc(codesRef, code), {
      prize,
      used: false
    });

    alert(`–°–æ–∑–¥–∞–Ω –∫–æ–¥:\n${code} ‚Üí ${prize}`);
    await loadCodes();
  }
  window.generateCode = generateCode;

  // ------------ –ó–ê–ì–†–£–ó–ö–ê –°–ü–ò–°–ö–ê –ö–û–î–û–í –í –ê–î–ú–ò–ù–ö–ï ------------
  async function loadCodes() {
    const snapshot = await getDocs(codesRef);
    let html = "";

    snapshot.forEach(docSnap => {
      const data = docSnap.data();
      html += `<div><b>${docSnap.id}</b> ‚Äî ${data.prize} ${data.used ? "‚úîÔ∏è (used)" : ""}</div>`;
    });

    document.getElementById("codes-list").innerHTML = html || "–ü—É—Å—Ç–æ";
  }

  // ------------ –ê–ö–¢–ò–í–ê–¶–ò–Ø –ö–û–î–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ú ------------
  let spinning = false;
  let currentPrize = null;

  async function activateCode() {
    const value = document.getElementById("code-input").value.trim().toUpperCase();
    const status = document.getElementById("status");

    if (!value) {
      status.innerText = "–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥";
      return;
    }

    // –≤—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω–∫—É
    if (value === "ADMIN123") {
      document.getElementById("admin-panel").style.display = "block";
      await loadCodes();
      status.innerText = "Admin mode activated ‚úîÔ∏è";
      return;
    }

    const docRef = doc(codesRef, value);
    const snap = await getDoc(docRef);

    if (!snap.exists()) {
      status.innerText = "‚ùå Invalid code";
      return;
    }

    const data = snap.data();

    if (data.used) {
      status.innerText = "‚õî This code has already been used";
      return;
    }

    currentPrize = data.prize;
    status.innerText = "Code accepted! üåÄ Spinning...";

    // –ø–æ–º–µ—á–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–º
    await updateDoc(docRef, { used: true });

    spinWheel();
  }
  window.activateCode = activateCode;

  // ------------ –í–†–ê–©–ï–ù–ò–ï –ö–û–õ–ï–°–ê ------------
  function spinWheel() {
    if (spinning) return;
    spinning = true;

    let targetIndex = values.indexOf(currentPrize);
    if (targetIndex === -1) {
      targetIndex = Math.floor(Math.random() * values.length);
    }

    const anglePerSector = 360 / values.length;
    const sectorCenter = targetIndex * anglePerSector + anglePerSector / 2;

    // —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã —Å–µ–∫—Ç–æ—Ä –æ–∫–∞–∑–∞–ª—Å—è —Å–≤–µ—Ä—Ö—É –ø–æ–¥ —Å—Ç—Ä–µ–ª–∫–æ–π (270¬∞)
    const fullTurns = 10;
    const finalRotation = fullTurns * 360 + (270 - sectorCenter);

    wheelCanvas.style.transition = "transform 5s cubic-bezier(.17,.67,.38,1.35)";
    wheelCanvas.style.transform = `rotate(${finalRotation}deg)`;

    setTimeout(() => {
      spinning = false;
      showPopup(currentPrize || values[targetIndex]);
    }, 5200);
  }
</script>

</body>
</html>
